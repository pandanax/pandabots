# –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞

## –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
2026-01-31

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞
```yaml
Name: n8n-server
ID: epdk7h2graaa04985hl0
Platform: standard-v3
CPU: 2 cores
RAM: 4 GB
Disk: 30 GB SSD
Zone: ru-central1-b
OS: Ubuntu 22.04 LTS
```

### –°–µ—Ç—å
```yaml
Network: n8n-network
Subnet: n8n-subnet (10.128.0.0/24)
External IP: 84.252.137.46 (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π)
Internal IP: 10.128.0.14
```

### Security Group
```yaml
Name: n8n-security-group

–í—Ö–æ–¥—è—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:
- SSH (port 22): —Ç–æ–ª—å–∫–æ —Å 93.158.188.119/32
- HTTP (port 80): 0.0.0.0/0 (–¥–ª—è Let's Encrypt)
- HTTPS (port 443): 0.0.0.0/0

–ò—Å—Ö–æ–¥—è—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:
- ALL: 0.0.0.0/0
```

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### SSH
```bash
ssh ubuntu@84.252.137.46
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ cloud-init
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh ubuntu@84.252.137.46

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å cloud-init
cloud-init status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥ cloud-init
tail -f /var/log/cloud-init-output.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker
docker --version
docker compose version

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
sudo ufw status
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ

Cloud-init –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª:
- ‚úÖ Docker Engine
- ‚úÖ Docker Compose (plugin –∏ standalone)
- ‚úÖ UFW firewall (–Ω–∞—Å—Ç—Ä–æ–µ–Ω: 22, 80, 443)
- ‚úÖ Fail2ban (–∑–∞–ø—É—â–µ–Ω)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/opt/n8n`
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `/opt/n8n/.env.example`

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –≤ reg.ru

–ó–∞–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º mandala-app.online –Ω–∞ reg.ru –∏ –¥–æ–±–∞–≤–∏—Ç—å A-–∑–∞–ø–∏—Å—å:

```
–¢–∏–ø: A
–ò–º—è: n8n
–ó–Ω–∞—á–µ–Ω–∏–µ: 84.252.137.46
TTL: 300
```

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑:
```bash
# –ü–æ–¥–æ–∂–¥–∞—Ç—å 1-5 –º–∏–Ω—É—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS
dig n8n.mandala-app.online

# –ò–ª–∏ —á–µ—Ä–µ–∑ nslookup
nslookup n8n.mandala-app.online
```

### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

```bash
ssh ubuntu@84.252.137.46

# –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è cloud-init
cloud-init status --wait

# –î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏: status: done
```

### 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å n8n —Å Docker Compose

–°–º. —Å–ª–µ–¥—É—é—â—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
- `docs/05-n8n-deployment.md` - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ n8n
- `docs/06-ssl-setup.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

## Terraform state

–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤:
```
terraform/terraform.tfstate
```

**–í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö. –ù–ï —É–¥–∞–ª—è–π –µ–≥–æ!

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```bash
cd terraform
terraform show
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä outputs
```bash
terraform output
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.tf` —Ñ–∞–π–ª—ã –∏–ª–∏ `terraform.tfvars`
2. `terraform plan` - –ø—Ä–æ–≤–µ—Ä—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. `terraform apply` - –ø—Ä–∏–º–µ–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –£–¥–∞–ª–∏—Ç –í–°–ï —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã!
```bash
terraform destroy
```

## –°—Ç–æ–∏–º–æ—Å—Ç—å

–ü—Ä–∏ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (2 vCPU, 4GB RAM, 30GB SSD, Static IP):
- **~6000-7000 —Ä—É–±/–º–µ—Å**

–¢–æ—á–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud.

## –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á

### –§–∞–∑–∞ 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Terraform
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Terraform
- ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Terraform provider
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ outputs

### –§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞—Ç—å VPC –∏ –ø–æ–¥—Å–µ—Ç—å
- ‚úÖ –°–æ–∑–¥–∞—Ç—å Security Group
- ‚úÖ –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- üî≤ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –∑–∞–ø–∏—Å–∏ –≤ reg.ru (–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é)

### –§–∞–∑–∞ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ Cloud-init –æ–±–Ω–æ–≤–∏–ª —Å–∏—Å—Ç–µ–º—É
- ‚úÖ Cloud-init —É—Å—Ç–∞–Ω–æ–≤–∏–ª Docker
- ‚úÖ Cloud-init –Ω–∞—Å—Ç—Ä–æ–∏–ª firewall
- ‚úÖ Cloud-init –Ω–∞—Å—Ç—Ä–æ–∏–ª fail2ban
- üî≤ –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ SSH –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
- üî≤ –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è cloud-init

### –°–ª–µ–¥—É—é—â–∞—è —Ñ–∞–∑–∞: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ n8n
- üî≤ –°–æ–∑–¥–∞—Ç—å docker-compose.yml
- üî≤ –°–æ–∑–¥–∞—Ç—å nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- üî≤ –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
- üî≤ –ü–æ–ª—É—á–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- üî≤ –ó–∞–ø—É—Å—Ç–∏—Ç—å n8n
